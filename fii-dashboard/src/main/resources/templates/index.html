<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>FII Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- sortable.js para ordenação -->
    <script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
</head>
<body class="bg-light">
<div class="container mt-5">
    <h1 class="text-center mb-4">FII Dashboard</h1>

    <div class="card mb-4">
        <div class="card-body">
            <h5>Resumo (Preço ≤ R$ <span th:text="${maxPreco}">1000</span>)</h5>
            <p>Total: <strong th:text="${resumo.total}">0</strong> FIIs</p>
            <p>Recomendados: <strong th:text="${resumo.recomendados}">0</strong></p>
            <p>DY Médio: <strong th:text="${#numbers.formatDecimal(resumo.dyMedio, 1, 2)}">0.00</strong>%</p>
        </div>
    </div>

    <div class="d-flex gap-2 mb-4">
        <a th:href="@{/?maxPreco=10}" class="btn btn-outline-primary">≤ R$10</a>
        <a th:href="@{/?maxPreco=50}" class="btn btn-outline-primary">≤ R$50</a>
        <a th:href="@{/?maxPreco=100}" class="btn btn-outline-primary">≤ R$100</a>
        <a th:href="@{/atualizar}" class="btn btn-success">Atualizar Dados</a>
    </div>

    <table class="table table-striped sortable" th:if="${fiis != null and !fiis.isEmpty()}">
        <thead>
        <tr>
            <th>Ticker</th>
            <th>Nome</th>
            <th>Preço</th>
            <th>P/VP</th>
            <th>DY</th>
            <th>Volume</th>
            <th>Recomendado</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="fii : ${fiis}" th:class="${fii.recomendado} ? 'table-success' : ''">
            <td th:text="${fii.ticker}"></td>
            <td th:text="${fii.nome}"></td>
            <td th:text="'R$ ' + ${#numbers.formatDecimal(fii.preco, 1, 2)}"></td>
            <td th:text="${#numbers.formatDecimal(fii.pvp, 1, 2)}"></td>
            <td th:text="${#numbers.formatDecimal(fii.dy, 1, 2)} + '%'"></td>
            <td th:text="${#numbers.formatInteger(fii.volume, 0, 'DEFAULT')}"></td>
            <td th:text="${fii.recomendado} ? 'SIM' : 'NÃO'"></td>
        </tr>
        </tbody>
    </table>

    <div th:if="${fiis == null or fiis.isEmpty()}" class="text-center">
        <p>Nenhum FII encontrado. Clique em "Atualizar Dados".</p>
    </div>
</div>
</body>
</html>
